<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE-edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tensorflow.js Transfer Learning</title>
    <link rel="stylesheet" href="/style.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
</head>

<body>
    <div class="container text-center">
        <div class="row">
            <div class="col"></div>
            <div class="col-6 mt-4">
                <h1>Teachable Machine using transfer learning with MobileNet v3</h1>
                <p id="status">Awaiting TF.js loaded</p>

                <!-- Initialize webcam -->
                <video id="webcam" autoplay></video>
                <div class="btn-group" role="group" aria-label="Basic outlined example">
                    <button type="button" class="btn btn-outline-primary" id="enableCam">Enable Webcam</button>
                    <button type="button" class="btn btn-outline-primary dataCollector" data-1hot="0"
                        data-name="Class 1">Gather Class 1</button>
                    <button type="button" class="btn btn-outline-primary dataCollector" data-1hot="1"
                        data-name="Class 2">Gather Class 2</button>
                    <button type="button" class="btn btn-outline-primary" id="train">Train &amp; Predict!</button>
                    <button type="button" class="btn btn-outline-primary" id="reset">Reset</button>
                </div>

                <div class="progress mt-4" role="progressbar" aria-label="Basic example" aria-valuenow="100"
                    aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar" style="width: 75%"></div>
                </div>

                <!-- Description -->
                <div class="alert alert-success mt-4" role="alert">
                    <h4 class="alert-heading">Brief Description</h4>
                    <p>
                        This is a web application that uses a TensorFlow.js model to classify two objects with a webcam.
                        The model I am using is MobileNetV3-Small-100-224, which is a lightweight image classification
                        model that can recognize 1000 different classes of objects. The model is pre-trained on the
                        ImageNet dataset, which is a large collection of images labeled with categories such as animals,
                        plants, vehicles, etc.
                    </p>
                </div>

                <!-- User guidance -->
                <p>
                    <a class="btn btn-primary" data-bs-toggle="collapse" href="#multiCollapseExample1" role="button"
                        aria-expanded="false" aria-controls="multiCollapseExample1">User Guild 1</a>
                    <button class="btn btn-primary" type="button" data-bs-toggle="collapse"
                        data-bs-target="#multiCollapseExample2" aria-expanded="false"
                        aria-controls="multiCollapseExample2">User Guild 2</button>
                    <button class="btn btn-primary" type="button" data-bs-toggle="collapse"
                        data-bs-target=".multi-collapse" aria-expanded="false"
                        aria-controls="multiCollapseExample1 multiCollapseExample2">Close both</button>
                </p>
                <div class="row">
                    <div class="col">
                        <div class="collapse multi-collapse" id="multiCollapseExample1">
                            <div class="card card-body">
                                First wait for about 1 min until the model loaded successfully.
                                Next enable the webcam by hitting the button and allow access.
                                Then when take the picture by pressing the button "gather class 1"
                                and then "gather class 2".
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="collapse multi-collapse" id="multiCollapseExample2">
                            <div class="card card-body">
                                After gathering enough pictures (at least 100) for two classes. Hit the button
                                "train and predict" and wait for the model to be trained (about 2mins). You can open
                                console log
                                to view the process of training. Finally, see the results
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="col"></div>
            <!-- https://teachable-machine-binary-classification.glitch.me/ -->
        </div>
    </div>

    <!-- Import TensorFlow.js library -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.11.0/dist/tf.min.js" type="text/javascript"></script>
    <script type="module" src="/script.js"></script>
</body>

</html>